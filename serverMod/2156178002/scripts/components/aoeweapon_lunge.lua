local a=Class(function(self,b)self.inst=b;self.width=3;self.damage=nil;self.stimuli=nil;self.onlunge=nil end)function a:SetWidth(c)self.width=c end;function a:SetStimuli(d)self.stimuli=d end;function a:SetOnLungeFn(e)self.onlunge=e end;function a:DoLunge(f,g,h)local i={}local j={}for k=0,10 do f:DoTaskInTime(FRAMES*math.ceil(1+k/3.5),function()local l=(h-g):GetNormalized()*k*0.6;SpawnPrefab("spear_gungnir_lungefx").Transform:SetPosition((g+l):Get())local m,n,o=(g+l):Get()local p=TheSim:FindEntities(m,n,o,self.width/2,nil,{"player","companion"})for q,r in ipairs(p)do if not i[r]and r~=f and f.components.combat:IsValidTarget(r)and(r.components.health or r.entity:IsValid()and r.components.workable and r.components.workable:CanBeWorked()and r.components.workable:GetWorkAction())then i[r]=true;table.insert(j,r)end end;if k==10 then if self.inst.components.weapon and self.inst.components.weapon:HasAltAttack()then self.inst.components.weapon:DoAltAttack(f,j,nil,self.stimuli)end end end)end;if self.onlunge~=nil then self.onlunge(self.inst,f,g,h)end;return true end;return a