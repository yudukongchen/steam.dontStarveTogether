local function ZG(JLCOx_ak)if JLCOx_ak.swinglight then JLCOx_ak.swinglight:Remove()end;if JLCOx_ak.childrenspawned then JLCOx_ak.childrenspawned:Remove()end end;local function Vu0cCAf(hPQ,R1FIoQI)if R1FIoQI=="day"then if hPQ.window then hPQ.AnimState:PlayAnimation("to_day")hPQ.AnimState:PushAnimation("day_loop",true)end elseif R1FIoQI=="night"then if hPQ.window then hPQ.AnimState:PlayAnimation("to_night")hPQ.AnimState:PushAnimation("night_loop",true)end elseif R1FIoQI=="dusk"then if hPQ.window then hPQ.AnimState:PlayAnimation("to_dusk")hPQ.AnimState:PushAnimation("dusk_loop",true)end end end;local function q(NsoTwDs,HGli)local iy=CreateEntity()iy.entity:AddTransform()iy.entity:AddAnimState()iy:AddTag("DECOR")iy:AddTag("NOCLICK")iy.persists=false;iy.AnimState:SetBank(NsoTwDs)iy.AnimState:SetBuild(HGli)iy.AnimState:PlayAnimation("light")iy.AnimState:SetLightOverride(.4)iy.AnimState:SetBloomEffectHandle("shaders/anim.ksh")iy.AnimState:SetFinalOffset(1)iy:Hide()return iy end local function kP7O5(m6SCS0)m6SCS0.AnimState:SetLayer(LAYER_WORLD_BACKGROUND)m6SCS0.AnimState:SetSortOrder(3)m6SCS0.Transform:SetRotation(90)m6SCS0.AnimState:SetScale(-1,1,1)m6SCS0.Transform:SetScale(1.2,1.2,1.2)m6SCS0.window=true end;local function lqT(NUhYw6R4)NUhYw6R4.AnimState:SetLayer(LAYER_WORLD_BACKGROUND)NUhYw6R4.AnimState:SetSortOrder(3)NUhYw6R4.Transform:SetScale(1.2,1.2,1.2)NUhYw6R4.window=true end;local function mP3mlD(Hv)Hv.Transform:SetScale(1.4,1.4,1.4)end;local function PrPyxMK(Ch)Ch.AnimState:SetScale(-1,1,1)Ch.Transform:SetScale(1.2,1.2,1.2)Ch.window=true end;local function tczrIB(urkh)urkh.Transform:SetScale(1.2,1.2,1.2)urkh.window=true end;local function a(zhzpBSx,rHSjalVy)if rHSjalVy=="night"then if zhzpBSx._light~=nil then zhzpBSx._light:Show()end else if zhzpBSx._light~=nil then zhzpBSx._light:Hide()end end end;local function wqU76o(TjhsnP)TjhsnP.GetIsWet=function(...)return false end end;local LB1Z={"spore_tall","spore_medium","spore_small"}local function N9L(t5jzEd9)return LB1Z[math.random(3)]end;local function hDc_M(JZAU2)return JZAU2:IsAsleep()end;local function qW0lRiD1(zPXTTg)if TUNING.HUA_MUSHROOMHOUS_SPORES then zPXTTg:AddComponent("periodicspawner")zPXTTg.components.periodicspawner:SetPrefab(N9L)zPXTTg.components.periodicspawner:SetRandomTimes(TUNING.MUSHROOMHAT_SPORE_TIME,1,true)zPXTTg.components.periodicspawner:SetDensityInRange(8,2)zPXTTg.components.periodicspawner:SetSpawnTestFn(hDc_M)zPXTTg.components.periodicspawner:Start()end end;local function iD1IUx(seMLr,qX,h_8,xL7OTb,w8T3f,K,qL,vfIyB)local quNsijN={"hua_window_round_light","hua_light_light","collapse_small"} local QUh2tc={Asset("ANIM","anim/hua_light.zip"),Asset("ANIM","anim/hua_light1.zip"),Asset("ANIM","anim/hua_light2.zip"),Asset("ANIM","anim/hua_window.zip"),Asset("ANIM","anim/hua_window_punk.zip"),Asset("ANIM","anim/hua_window_round_new.zip"),Asset("ANIM","anim/hua_window_punk_new.zip")} local function qboV()local nSBOx7=CreateEntity()nSBOx7.entity:AddTransform()nSBOx7.entity:AddAnimState()nSBOx7.entity:AddNetwork()nSBOx7.entity:AddSoundEmitter()nSBOx7.AnimState:SetBank(h_8)nSBOx7.AnimState:SetBuild(qX)nSBOx7.AnimState:PlayAnimation(xL7OTb,true)if K~=nil then K(nSBOx7)end;for u,Ki1 in ipairs(vfIyB)do nSBOx7:AddTag(Ki1)end;nSBOx7:AddTag("nonpackable")wqU76o(nSBOx7)if not TheNet:IsDedicated()then if seMLr=="hua_light_red"or seMLr=="hua_light_red1"or seMLr=="hua_light_red2"then nSBOx7._light=q(h_8,qX)nSBOx7._light.entity:SetParent(nSBOx7.entity)nSBOx7:WatchWorldState("phase",a)a(nSBOx7,TheWorld.state.phase)end end;nSBOx7.entity:SetPristine()if not TheWorld.ismastersim then return nSBOx7 end;nSBOx7.AnimState:SetTime(math.random()*nSBOx7.AnimState:GetCurrentAnimationLength())if(seMLr~="hua_window_round_light"or seMLr~="hua_window_punk_light")then nSBOx7:AddComponent("inspectable")end;nSBOx7:DoTaskInTime(0,function()if w8T3f~=nil and not nSBOx7.sunraysspawned then nSBOx7.swinglight=nSBOx7:SpawnChild("hua_light_light")nSBOx7.swinglight.setLightType(nSBOx7.swinglight,w8T3f)nSBOx7.sunraysspawned=true;if w8T3f=="natural"then nSBOx7.swinglight.setListenEvents(nSBOx7.swinglight)end end;if qL~=nil then if not nSBOx7.childrenspawned then local zz1QI=SpawnPrefab(qL)local kFTAh=Vector3(nSBOx7.Transform:GetWorldPosition()) zz1QI.Transform:SetPosition(kFTAh.x,kFTAh.y,kFTAh.z)zz1QI.Transform:SetRotation(nSBOx7.Transform:GetRotation())nSBOx7.childrenspawned=zz1QI end end end)nSBOx7:ListenForEvent("onremove",function()ZG(nSBOx7)end)nSBOx7:WatchWorldState("phase",Vu0cCAf)Vu0cCAf(nSBOx7,TheWorld.state.phase)if(seMLr=="hua_window_round_light"or seMLr=="hua_window_punk_light")then nSBOx7.persists=false end;if seMLr=="hua_light_red"then qW0lRiD1(nSBOx7)end;return nSBOx7 end;return Prefab(seMLr,qboV,QUh2tc,quNsijN)end return iD1IUx("hua_light_red","hua_light","hua_light","red","electric_1",mP3mlD,nil,{"NOBLOCK","waterproofer"}),iD1IUx("hua_light_red1","hua_light1","hua_light1","red","electric_2",mP3mlD,nil,{"NOBLOCK","waterproofer"}),iD1IUx("hua_light_red2","hua_light2","hua_light2","red","electric_3",mP3mlD,nil,{"NOBLOCK","waterproofer"}),iD1IUx("hua_window_round","hua_window_round_new","hua_window_side","day_loop",nil,kP7O5,"hua_window_round_light",{"NOBLOCK","waterproofer"}),iD1IUx("hua_window_round_light","hua_window_round_new","hua_window_light_side","day_loop","natural",PrPyxMK,nil,{"NOBLOCK","NOCLICK"}),iD1IUx("hua_window_punk","hua_window_punk_new","hua_window_punk","day_loop",nil,lqT,"hua_window_punk_light",{"NOBLOCK","waterproofer"}),iD1IUx("hua_window_punk_light","hua_window_punk_new","hua_window_punk_light","day_loop","natural",tczrIB,nil,{"NOBLOCK","NOCLICK"})